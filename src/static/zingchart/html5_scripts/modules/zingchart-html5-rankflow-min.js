/*
All of the code within the ZingChart software is developed and copyrighted by PINT, Inc., and may not be copied,
replicated, or used in any other software or application without prior permission from PINT. All usage must coincide with the
ZingChart End User License Agreement which can be requested by email at support@zingchart.com.

Build 0.120731
*/
zingchart.setModule("rankflow");
(function(){ZC.ZCRankFlow=function(){this.A38="palette";this.BM="#6a921f";this.AZ=[];this.TL=0;this.A3M=function(){for(var l=(Math.random()*16777215+1<<0).toString(16);l.length<6;)l="0"+l;return"#"+l}};var p,A=0,y=0,u=null,G=zingchart.label_click;zingchart.label_click=function(l){G!=null&&G(l);var e=zingchart.getLoader(l.id);if(e){e=zingchart.getGraph(e,l.graphid);if(!(!e||e.o.type!="rankflow")){if(!u){u={};for(e=0;e<A;e++)u["s"+e]=0}if(l.labelid.substring(0,13)=="item_overall_"){e=ZC._i_(l.labelid.split("_")[2]);
u["s"+e]=!u["s"+e];e=[];for(var a=[],n=0,h=0;h<A;h++)n=n||u["s"+h];for(h=0;h<A;h++){e.push({id:"flow_"+h,alpha:u["s"+h]||!n?1:0.25});a.push({id:"item_overall_"+h,alpha:u["s"+h]||!n?1:0.25});for(var D=0;D<y;D++)a.push({id:"item_"+h+"_"+D,alpha:u["s"+h]||!n?1:0.25,"text-alpha":u["s"+h]||!n?1:0.25})}zingchart.exec(l.id,"updateobject",{type:"shape",data:e,update:false});zingchart.exec(l.id,"updateobject",{type:"label",data:a,update:false});zingchart.exec(l.id,"HAobjects",{})}}}};var H=zingchart.dataparse;
zingchart.dataparse=function(l,e){if(H!=null)e=H(l,e);var a,n=zingchart.getLoader(l.id);zingchart.initThemes(n);for(var h=0,D=e[ZC._[18]].length;h<D;h++)if(e[ZC._[18]][h].type=="rankflow"){var s=e[ZC._[18]][h].type,k=e[ZC._[18]][h],d={};if(k.options)d=k.options[s]||k.options;ZC._todash_(d);s=d.style||{};var f=zingchart.getGraphInfo(n,e,h);k.shapes||(k.shapes=[]);k[ZC._[12]]||(k[ZC._[12]]=[]);p=new ZC.ZCRankFlow;if((a=d["color-type"])!=null)p.A38=a;if((a=d.color)!=null)p.BM=ZC.BP.LQ(a);if((a=d.palette)!=
null)p.AZ=a;if((a=d["static"])!=null)p.TL=ZC._b_(a);var F=[],o=[],v=k[ZC._[52]]||{};if(a=v[ZC._[5]])F=a;if(a=v[ZC._[12]])o=a;var m=k[ZC._[13]],c,b,g=0,i=0,x=0,q=0,r=0;for(a=0;a<o.length;a++){b={text:o[a],bold:true};ZC._cp_(v.item,b);c=new ZC.D1(n);c.append(b);c.parse();g=ZC.BR(g,c.G);x=ZC.BR(x,c.E)}for(a=0;a<m.length;a++){var B=m[a].style||{};b={text:m[a].text};ZC._cp_(s["item-flow"],b);ZC._cp_(B["item-flow"],b);c=new ZC.D1(n);c.append(b);c.parse();g=ZC.BR(g,c.G);i=ZC.BR(i,c.E)}b={text:a,bold:true};
c=new ZC.D1(n);c.append(b);c.parse();q=ZC.BR(q,c.G);if(q<i)q=i;b={text:a,bold:true,width:2*q};ZC._cp_(s["rank-overall"],b);c=new ZC.D1(n);c.append(b);c.parse();r=ZC.BR(r,c.G);if(r<i)r=i;A=m.length;y=ZC.BR(F.length,o.length);for(a=0;a<A;a++){var z=m[a].ranks||[];y=ZC.BR(y,z.length)}c=[0,0,0,0];if((a=d.margin)!=null)c=(new ZC.G4(null)).m_(a,"all",f.plotarea.width,f.plotarea.height);f.plotarea.x+=c[3];f.plotarea.y+=c[0];f.plotarea.width-=c[1]+c[3];f.plotarea.height-=c[0]+c[2];c=(f.plotarea.width-r-3*
q-(y+1)*g)/y;var w=ZC._i_((f.plotarea.height-x-m.length*i)/(m.length+1)),C=c;if((a=d["col-space"])!=null)c=ZC._i_(a);if((a=d["row-space"])!=null)w=ZC._i_(a);if((a=d["sep-space"])!=null)C=ZC._i_(a);var j;d=f.plotarea.x;j=f.plotarea.y;if(x>0){b={bold:true,text:"OVERALL<br>RANK","static":true};ZC._cp_(v.item,b);ZC._cp_(s["label-overall"],b);ZC._cp_({x:d,y:j,width:r+g},b);k[ZC._[12]].push(b);for(a=0;a<o.length;a++){d=f.plotarea.x+r+g+C+1.5*q+a*(g+c);j=f.plotarea.y;b={bold:true};ZC._cp_(v.item,b);ZC._cp_({x:d,
y:j,width:g,"static":true,text:o[a]},b);k[ZC._[12]].push(b)}}for(a=0;a<A;a++){d=f.plotarea.x+r+g+C;j=f.plotarea.y+x+w+a*(i+w);b={color:"#000",bold:true,"background-color":"#999"};ZC._cp_(s["rank-left"],b);ZC._cp_({id:"rank_"+(a+1)+"_l",x:d,y:j,width:q,height:i,"static":true,text:a+1},b);k[ZC._[12]].push(b);d=f.plotarea.x+r+g+C+1.5*q+y*(g+c)-c+q/2;b={color:"#000",bold:true,"background-color":"#999"};ZC._cp_(s["rank-right"],b);ZC._cp_({id:"rank_"+(a+1)+"_r",x:d,y:j,width:q,height:i,"static":true,text:a+
1},b);k[ZC._[12]].push(b);d=f.plotarea.x;b={color:"#fff",bold:true,"background-color":"#333"};ZC._cp_(s["rank-overall"],b);ZC._cp_({id:"rank_"+(a+1)+"_g",x:d,y:j,width:r,height:i,"static":true,text:a+1},b);k[ZC._[12]].push(b)}for(a=0;a<m.length;a++){B=m[a].style||{};v=p.BM;if(p.A38=="palette")v=p.AZ.length>0?p.AZ[a%p.AZ.length]:zingchart.getPalette(n,a,"bar")[1];else if(p.A38=="random")v=p.A3M();d=f.plotarea.x+r;j=f.plotarea.y+x+w+a*(i+w);if((m[a].ranks||-1)!=-1){b={"background-color":v,color:"#fff"};
ZC._cp_(s["item-overall"],b);ZC._cp_(B["item-overall"],b);ZC._cp_({id:"item_overall_"+a,x:d,y:j,width:g,height:i,"static":p.TL,text:m[a].text},b);k[ZC._[12]].push(b)}z=m[a].ranks;o=[];for(var t=0;t<z.length;t++){d=f.plotarea.x+r+g+C+1.5*q+t*(g+c);j=f.plotarea.y+x+w+(z[t]-1)*(i+w);o.push([d,j]);o.push([d+g,j]);var E={"background-color":"#fff",color:"#333","border-width":1,"border-color":"#999",padding:10,text:"%text ranked on %rank at %scale-value"};ZC._cp_(s.tooltip,E);ZC._cp_(B.tooltip,E);E.text=
E.text.replace(/%text/gi,m[a].text).replace(/%rank/gi,z[t]).replace(/%scale-value/gi,F[t]);b={color:"#fff"};ZC._cp_(s["item-flow"],b);ZC._cp_(B["item-flow"],b);ZC._cp_({id:"item_"+a+"_"+t,x:d,y:j,width:g,height:i,text:m[a].text,tooltip:E},b);k[ZC._[12]].push(b)}o.push([d+g,j+i]);for(t=z.length-1;t>=0;t--){d=f.plotarea.x+r+g+C+1.5*q+t*(g+c);j=f.plotarea.y+x+w+(z[t]-1)*(i+w);o.push([d+g,j+i]);o.push([d,j+i])}o.push([d,j]);b={"background-color":v,shadow:true};ZC._cp_(k.plot,b);ZC._cp_(m[a],b);ZC._cp_(s.flow,
b);ZC._cp_(B.flow,b);ZC._cp_({id:"flow_"+a,type:"poly",points:o,"static":true,label:{visible:false}},b);k.shapes.push(b)}}return e}})();
